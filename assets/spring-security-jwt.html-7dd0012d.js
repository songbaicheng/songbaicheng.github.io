import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o as k,c as d,d as a,n as m,g as v,w as t,a as n,b as s,e as b}from"./app-59578cdd.js";const g="/assets/images/study/backend/java/spring/spring-security-jwt/jwt-decode.png",h={},j=n("h1",{id:"spring-security-jwt",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#spring-security-jwt","aria-hidden":"true"},"#"),s(" Spring Security + JWT")],-1),w=n("h2",{id:"前言",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),s(" 前言")],-1),y=n("p",null,"说到 JWT（JSON Web Token），我们首先要知道 Token 是什么，想要知道 Token 是什么，我们就得先谈一下早期 Session 登录的时代，下面是之前 Session 登录的大致流程。",-1),f=n("p",null,"然而，随着应用程序的复杂性和扩展性的增加，分布式系统和跨服务的场景变得更加常见。在这种情况下，使用基于 Session 会话的登录可能会面临一些挑战，例如会话状态的同步和跨服务的会话管理。而且如果 Cookie 如果被截获，用户就会很容易受到跨站请求伪造（CSRF）的攻击。于是令牌（Token）应运而生，Token 承载了用户身份信息和其他必要的声明，无需在服务器端存储会话信息，使其具备了无状态性（stateless）的特性。这样可以减轻服务器的负担，并且适用于分布式环境和跨服务的场景。基于这种特性 Token 的登录过程如下所示。",-1),x=n("p",null,"虽然看似流程上十分相似，但是每个请求都必须携带包含了所有必要的用户身份信息和声明的令牌来进行身份验证，而且令牌可以通过签名和加密机制来保护身份信息的完整性和真实性，这样极大的保证了安全性的同时也解决了跨域支持的问题。JWT 官网也告诉了我们什么是 JSON Web Token 并告诉我们什么情况下可以去使用它，如果有兴趣可以点击下面链接去深入了解。",-1),J=n("h2",{id:"快速开始",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#快速开始","aria-hidden":"true"},"#"),s(" 快速开始")],-1),E=n("h3",{id:"引入依赖",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#引入依赖","aria-hidden":"true"},"#"),s(" 引入依赖")],-1),C=n("div",{class:"language-xml line-numbers-mode","data-ext":"xml"},[n("pre",{class:"language-xml"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("properties")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("jjwt.version")]),n("span",{class:"token punctuation"},">")]),s("0.11.5"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("jjwt.version")]),n("span",{class:"token punctuation"},">")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("properties")]),n("span",{class:"token punctuation"},">")]),s(`

`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("dependencies")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s("io.jsonwebtoken"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s("jjwt-api"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("version")]),n("span",{class:"token punctuation"},">")]),s("${jjwt.version}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("version")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s("io.jsonwebtoken"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s("jjwt-impl"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("version")]),n("span",{class:"token punctuation"},">")]),s("${jjwt.version}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("version")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("scope")]),n("span",{class:"token punctuation"},">")]),s("runtime"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("scope")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s("io.jsonwebtoken"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("groupId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s("jjwt-jackson"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("artifactId")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("version")]),n("span",{class:"token punctuation"},">")]),s("${jjwt.version}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("version")]),n("span",{class:"token punctuation"},">")]),s(`
        `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("scope")]),n("span",{class:"token punctuation"},">")]),s("runtime"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("scope")]),n("span",{class:"token punctuation"},">")]),s(`
    `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("dependency")]),n("span",{class:"token punctuation"},">")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("dependencies")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),T=n("div",{class:"language-gradle line-numbers-mode","data-ext":"gradle"},[n("pre",{class:"language-gradle"},[n("code",null,[s("ext "),n("span",{class:"token punctuation"},"{"),s(`
    jjwtVersion `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'0.11.5'"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"dependencies"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"implementation"),s(),n("span",{class:"token interpolation-string"},[n("span",{class:"token string"},'"io.jsonwebtoken:jjwt-api:'),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"$"),n("span",{class:"token expression"},"jjwtVersion")]),n("span",{class:"token string"},'"')]),s(`
    runtimeOnly `),n("span",{class:"token interpolation-string"},[n("span",{class:"token string"},'"io.jsonwebtoken:jjwt-impl:'),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"$"),n("span",{class:"token expression"},"jjwtVersion")]),n("span",{class:"token string"},'"')]),s(`
    runtimeOnly `),n("span",{class:"token interpolation-string"},[n("span",{class:"token string"},'"io.jsonwebtoken:jjwt-jackson:'),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"$"),n("span",{class:"token expression"},"jjwtVersion")]),n("span",{class:"token string"},'"')]),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),S=n("h3",{id:"系统参数配置和读取",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#系统参数配置和读取","aria-hidden":"true"},"#"),s(" 系统参数配置和读取")],-1),A=n("div",{class:"language-yaml line-numbers-mode","data-ext":"yml"},[n("pre",{class:"language-yaml"},[n("code",null,[n("span",{class:"token key atrule"},"jwt"),n("span",{class:"token punctuation"},":"),s(`
  `),n("span",{class:"token key atrule"},"secret"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token key atrule"},"jwt"),n("span",{class:"token punctuation"},":"),s(`
  `),n("span",{class:"token key atrule"},"secret"),n("span",{class:"token punctuation"},":"),s(" 650e387e"),n("span",{class:"token punctuation"},"-"),s("d8ba"),n("span",{class:"token punctuation"},"-"),s("43cd"),n("span",{class:"token punctuation"},"-"),s("9237"),n("span",{class:"token punctuation"},"-"),s("a9274a675f7b "),n("span",{class:"token comment"},"# 与HMAC-SHA算法一起使用的密钥必须具有>=256位的大小"),s(`
  `),n("span",{class:"token key atrule"},"expiration"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token number"},"3600"),s(),n("span",{class:"token comment"},"# 设置为令牌的有效期时间（单位：秒）"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),B=n("div",{class:"language-java line-numbers-mode","data-ext":"java"},[n("pre",{class:"language-java"},[n("code",null,[n("span",{class:"token annotation punctuation"},"@Setter"),s(`
`),n("span",{class:"token annotation punctuation"},"@Getter"),s(`
`),n("span",{class:"token annotation punctuation"},"@Configuration"),s(`
`),n("span",{class:"token annotation punctuation"},"@ConfigurationProperties"),n("span",{class:"token punctuation"},"("),s("prefix "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"jwt"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"JwtConfig"),s(),n("span",{class:"token punctuation"},"{"),s(`

    `),n("span",{class:"token doc-comment comment"},`/**
     * 密钥
     */`),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"String"),s(" secret"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token doc-comment comment"},`/**
     * 过期时间
     */`),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token keyword"},"long"),s(" expiration"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),q=n("h3",{id:"工具类方法",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#工具类方法","aria-hidden":"true"},"#"),s(" 工具类方法")],-1),W=n("div",{class:"language-java line-numbers-mode","data-ext":"java"},[n("pre",{class:"language-java"},[n("code",null,[n("span",{class:"token keyword"},"package"),s(),n("span",{class:"token namespace"},[s("com"),n("span",{class:"token punctuation"},"."),s("sbc"),n("span",{class:"token punctuation"},"."),s("boot3"),n("span",{class:"token punctuation"},"."),s("utils")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("com"),n("span",{class:"token punctuation"},"."),s("sbc"),n("span",{class:"token punctuation"},"."),s("boot3"),n("span",{class:"token punctuation"},"."),s("config"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"JwtConfig")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("io"),n("span",{class:"token punctuation"},"."),s("jsonwebtoken"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"Jwts")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("io"),n("span",{class:"token punctuation"},"."),s("jsonwebtoken"),n("span",{class:"token punctuation"},"."),s("security"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"Keys")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("lombok"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"RequiredArgsConstructor")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("org"),n("span",{class:"token punctuation"},"."),s("springframework"),n("span",{class:"token punctuation"},"."),s("stereotype"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"Component")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("java"),n("span",{class:"token punctuation"},"."),s("nio"),n("span",{class:"token punctuation"},"."),s("charset"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"StandardCharsets")]),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token import"},[n("span",{class:"token namespace"},[s("java"),n("span",{class:"token punctuation"},"."),s("util"),n("span",{class:"token punctuation"},".")]),n("span",{class:"token class-name"},"Date")]),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token annotation punctuation"},"@Component"),s(`
`),n("span",{class:"token annotation punctuation"},"@RequiredArgsConstructor"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"JwtUtils"),s(),n("span",{class:"token punctuation"},"{"),s(`

    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token keyword"},"final"),s(),n("span",{class:"token class-name"},"JwtConfig"),s(" jwtConfig"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token doc-comment comment"},`/**
     * 定义系统标识头常量
     */`),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token keyword"},"static"),s(),n("span",{class:"token keyword"},"final"),s(),n("span",{class:"token class-name"},"String"),s(),n("span",{class:"token constant"},"HEADER_SYSTEM_KEY"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"JWT"'),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token doc-comment comment"},[s(`/**
     * 根据用户ID生成JWT
     *
     * `),n("span",{class:"token keyword"},"@param"),s(),n("span",{class:"token parameter"},"username"),s(` 用户名
     * `),n("span",{class:"token keyword"},"@return"),s(` JWT
     */`)]),s(`
    `),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token class-name"},"String"),s(),n("span",{class:"token function"},"generateToken"),n("span",{class:"token punctuation"},"("),n("span",{class:"token class-name"},"String"),s(" username"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token class-name"},"Jwts"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"builder"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setExpiration"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"generateExpirationDate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setSubject"),n("span",{class:"token punctuation"},"("),s("username"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"signWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token class-name"},"Keys"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hmacShaKeyFor"),n("span",{class:"token punctuation"},"("),s("jwtConfig"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"getSecret"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"getBytes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token class-name"},"StandardCharsets"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"UTF_8"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"compact"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token doc-comment comment"},`/**
     * 生成token的过期时间
     */`),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"Date"),s(),n("span",{class:"token function"},"generateExpirationDate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Date"),n("span",{class:"token punctuation"},"("),n("span",{class:"token class-name"},"System"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"currentTimeMillis"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"+"),s(" jwtConfig"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"getExpiration"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1000"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),F=n("h3",{id:"请求获取-token",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#请求获取-token","aria-hidden":"true"},"#"),s(" 请求获取 Token")],-1),O=n("div",{class:"language-java line-numbers-mode","data-ext":"java"},[n("pre",{class:"language-java"},[n("code",null,[n("span",{class:"token annotation punctuation"},"@RestController"),s(`
`),n("span",{class:"token annotation punctuation"},"@RequiredArgsConstructor"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"AuthController"),s(),n("span",{class:"token punctuation"},"{"),s(`

    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token keyword"},"final"),s(),n("span",{class:"token class-name"},"JwtUtils"),s(" jwtUtils"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token doc-comment comment"},[s(`/**
     * 生成token
     * `),n("span",{class:"token keyword"},"@param"),s(),n("span",{class:"token parameter"},"user"),s(` 用户信息
     * `),n("span",{class:"token keyword"},"@return"),s(` Token
     */`)]),s(`
    `),n("span",{class:"token annotation punctuation"},"@PostMapping"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/token"'),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token class-name"},"ResponseEntity"),n("span",{class:"token generics"},[n("span",{class:"token punctuation"},"<"),n("span",{class:"token class-name"},"String"),n("span",{class:"token punctuation"},">")]),s(),n("span",{class:"token function"},"authenticateUser"),n("span",{class:"token punctuation"},"("),n("span",{class:"token annotation punctuation"},"@RequestBody"),s(),n("span",{class:"token class-name"},"SecurityUser"),s(" user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`

        `),n("span",{class:"token class-name"},"String"),s(" token "),n("span",{class:"token operator"},"="),s(" jwtUtils"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"generateToken"),n("span",{class:"token punctuation"},"("),s("user"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"getUsername"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token class-name"},"ResponseEntity"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ok"),n("span",{class:"token punctuation"},"("),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),R=b('<h3 id="token-解码" tabindex="-1"><a class="header-anchor" href="#token-解码" aria-hidden="true">#</a> Token 解码</h3><p>拿到 Token 之后可以去官网解码查看生成的内容是否正确。</p><figure><img src="'+g+`" alt="Token 解码" tabindex="0" loading="lazy"><figcaption>Token 解码</figcaption></figure><h2 id="走进-jwt" tabindex="-1"><a class="header-anchor" href="#走进-jwt" aria-hidden="true">#</a> 走进 JWT</h2><p>在官网我们可以看到对 JWT 的介绍也不算很多，知道它是一种用于在网络应用间安全传递信息的开放标准（RFC 7519），通过使用数字签名或加密方式，可以将声明式的JSON数据进行安全地传输。而对我开发有帮助的是我们需要知道 JWT 是有三个部分组成的：头部（Header）、载荷（Payload）和签名（Signature），现在我们重点说说这三个部分：</p><h3 id="头部-header" tabindex="-1"><a class="header-anchor" href="#头部-header" aria-hidden="true">#</a> 头部（Header）</h3><p>头部通常由两部分组成：令牌类型（typ）和签名算法（alg）。这些信息被用于描述JWT的类型和所采用的签名算法。头部使用JSON对象表示，并且需要通过Base64编码进行传输。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="载荷-payload" tabindex="-1"><a class="header-anchor" href="#载荷-payload" aria-hidden="true">#</a> 载荷（Payload）</h3><p>载荷部分包含了JWT的声明信息，它是存储实际数据的地方。载荷也是一个JSON对象，并且需要通过Base64编码进行传输。载荷包含了一些预定义的声明（Claim），以及可以自定义的声明。预定义的声明包括了一些标准的声明名称，如iss（签发者）、sub（主题）、exp（过期时间）、iat（签发时间）等。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;admin&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exp&quot;</span><span class="token operator">:</span> <span class="token number">1688283529</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="签名-signature" tabindex="-1"><a class="header-anchor" href="#签名-signature" aria-hidden="true">#</a> 签名（Signature）</h3><p>签名部分是对头部和载荷进行数字签名的结果，以确保JWT的完整性和真实性。签名通过使用头部中指定的算法和密钥进行生成。签名可以帮助验证JWT是否被篡改过。我们看到的签名部分是将Base64编码的头部和Base64编码的载荷通过某种方式（如使用&quot;.&quot;进行连接）组合成一个字符串，然后使用指定的签名算法和密钥对这个字符串进行签名生成签名值形成的。</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>HMACSHA256(
  base64UrlEncode(header) + <span class="token string">&quot;.&quot;</span> + base64UrlEncode(payload)<span class="token punctuation">,</span>
  secret
)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭配-spring-security" tabindex="-1"><a class="header-anchor" href="#搭配-spring-security" aria-hidden="true">#</a> 搭配 Spring Security</h3>`,15);function I(N,P){const i=e("FlowChart"),p=e("VPCard"),u=e("CodeTabs"),o=e("CodeDemo");return k(),d("div",null,[j,w,y,a(i,{id:"flowchart-9",code:"eJx9VF1P2mAUvu+vIF5tF/wBE2oW3YXLsi0j2z2BOpuZdmlRtztgCqggOIHJ1xQ3keikbNmkfMmf6XnbXvkXdl5aK626q75Jz3me8/E8R46GpGiAnXxmfTCMwekOIwpcgBU/cFIoyovCrE8vtEi6a8YqxjhlNFqQLZJ0CTYvtUGJlHowzJFcXuv/sMIgn4UvGVCS+lGcia6LLiRSy8J2A8otsntCCpeQ7ujlAYyKhtIlvxLXw4x5ljGUuIVEUa+qemXjLjA5UCDfJLUtUkwzvPwkHBZXhVchWV4Xpci8KElcOMpFAmxYFCK8RW38aUKu60q/+K432nMMJ0T8nCQFWHy448xC2VAUJrosce6JOH1ow4qm9g3lxK4xXYVBX1NjmnoGBQUfWD7GGEqdHKUMBP3ZvB6mg5wsI45vceF6uMUsiatIfh86dJII7cmHiwNItKDWcsL0c4WOLlYBVdXGdRpQa0FyEx+aeoG7Ipm41tuETAkHToodkm1Dfx9/MUv82gONIbWXN7dnxuJQ/QbtY2x1mtSWRvtKH7Xt5vNZnMvMs+DTYHDx5YvFhRkchG9eFN/zHCPzH12kDqAlCS9vfheJsB6qOKe7m5RbWB9tSObWOOF+cK23g1AYT5QcVmhJzvw8onSpM9humeUNUJt3tuXq8YbLYwDcKTQTvjevn/sgl8AR071y/Ltl9Na908Xt3TjAKoR8vUQqJCdHPdyPpwpyeEK2rkDpQb/gKEobN0hcQfnbcnobWuHdmrdRpswyxwi8x91utdFajNMkLg+6v/VBzl5t/1wbjCxzMlHPhB0AoxnHbPtapLKk1DHGVaORmc7GweEvaFcgv+fY32z8NevHEyOGVlZsI+qDfVI/ZJjJbfKzeJToYfKzeFPoXfGzD/r+4Yvw6BMnP0YIauj/RAkiBtlnwXpgWdYZ8LPUrhPP4hPtM/GQn0VNU13jgyrQ0iGmUglYQqD1Ti/Ksze7MrqdW0ZPyKQsnP5twD/w6jn3",preset:"vue"}),f,a(i,{id:"flowchart-13",code:"eJx9VNtS2lAUfc9X8Ng+8APOkI7jD3TaTt8ZiDWjk3QS1LZP4BUEhJGLgkGkWmS0ENqx3JGPafY5yZO/0H1yKAKVPuVMZl/W2mvtrYf8Wsgnup8lDwzCcBMXVEXyiepHSfOHZFVZ8tBsjUTbTrhojw7tSg2SORLNw37L6udJvguDFEmlrd41D4N0Ek4SYB7Qy4gQ2lZnKhEjCUcVKNTI8TeSbUG0SQt9GOZss01+7DwOEs5twjYjvBKr+nBOi3v/FiZnJqSrxIiRXFSQ9eVAQN1UXvt1fVvVgiuqpkmBkBT0iQFVCcq8tX1fhVR7Jr1+RSuNV4KkBL2SpvlEfMzGOdmCbZpCaE2TZicy4WENijRbJtG01QlbnVurf01jicdB9J26LimPgxhSgsQ+pO84B7t3Z/WH1qhCIiYj484QRvt2NYI84apJzo4x23qIQ3WHlHadQvp3OIJjJ0aZnLac03tax5ox6LasUQnqZ2DU6CCDjwkiTH8jBWUdo6xOXVhVN5HZc9ChecDh2qMsnF/QfgEaXxEjvTOZEOEidDpcc8gkoZdFgCTXJMmGNcxgZYa3fkoav9ALNNaFRpH9cSPh+t7ZrQmr8tbs1Cb1ufS8O6SRcQLBsGH85TSFJMqRoGTE+A5GkwXs4CzznhVVXZcl5Cno8qfnG1ndONZnyM0UysNt5uwOUbYJfWtoWJ0eV4bbDw7rSNMp7MHRJYLhWUh5biz8PyeLLTzLm6E1VZO/uCA8fDiCLm1JygIBjKc14LVQYuyB4DgOjo+hd41OwjfoGWqUoXGBb/T9W0nXseZ7/4Y8a/YxM9dn07uCZpc/rOHCLzAEh2HfHOBEoP2T9lNjqlPTERR57j5MKqCNMX18Lg6TJN+0R+d2JTGdjsqR+Antl3gvd/v8Gxvj7aP9DCmVBcE9SF4RLxG7Rl4RDwk7Jl5x4bIvPgMvPkv6SyzBtvg/UYqKQeNbwB8Ii+++V2Rr5O4SPtHWrre9IvqOeQ8fTGWuNYM4rcucTGMwrgxPXeZiXChszE8RfwARyjzb",preset:"vue"}),x,a(p,m(v({title:"JWT 官网",desc:"点击跳转官网查看详细内容",logo:"/assets/images/study/backend/java/spring/spring-security/jwt.svg",link:"https://jwt.io/",color:"rgba(173, 216, 590, 0.15)"})),null,16),J,E,a(u,{id:"24",data:[{id:"Maven"},{id:"Gradle"}]},{title0:t(({value:c,isActive:l})=>[s("Maven")]),title1:t(({value:c,isActive:l})=>[s("Gradle")]),tab0:t(({value:c,isActive:l})=>[C]),tab1:t(({value:c,isActive:l})=>[T]),_:1}),S,a(o,{id:"code-demo-35",type:"normal",title:"jwt%20%E6%89%80%E9%9C%80%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E5%92%8C%E8%AF%BB%E5%8F%96%E4%BB%A3%E7%A0%81",code:"eJx1kF1LwlAcxr/KYd2UNBSnmy4MxYskCAJvd3OcR5msbWzHlxChiyyFLJBEECECw64s6EVJzS+zF73yK3RkWSB1rv4P5//8/jxPmTqFJzLFU7ki5gUFAAOJOsI82NRs0IeYEIfodCgF6QAjpumwn+FoGPZzAchywQyXAlvAHF0njmJxOpmIOYO2/dIyR2fzt6E5nTm3j07n3Hq6WDQfrFl1cT+2qkO7W9+P+IOsOW2sPnt96/lmdRWVNEmHWFIVHjCsz0fI88GnMx2Yow9z3HPqV2SdmO1Wze7e2e33Rft1OalZjRYhLScdp99cTuqCQu1SOViAJF80iTBGuqBED9ZDXFUyUjbv3tnUx7qqIR1LyNjWdJSRSiAChFVLArUjKFo+JUsiEGVoGOCwiF0rKAuEA8jzejzuADzAjbyWXnfQdKkAMQJJrEtK9rvlvb/s89nlT8R/ILJKEL+VEUyFRK98AfFlx0o="},{default:t(()=>[A,B]),_:1}),q,a(o,{id:"code-demo-42",type:"normal",title:"jwt%20%E5%B7%A5%E5%85%B7%E7%B1%BB%E7%94%9F%E6%88%90%20Token%20%E4%BB%A3%E7%A0%81",code:"eJx1U0Fr2zAU/isiJ7sDNWOXsTFol6RsLb3UKaUQCLKjOEpsyZPkZqH0NpbuUNZDoVAG6WGHnbrDytbSw/7M4rT/Yk92nLglET7I0vc+fe977x2WuuSAlF6VIuL1iE+RJ0KsXA+7QugXONYsUK8bvMFZGAmpn1x7greZjzf7upLuADnFMYG7SvA+dbXoUW4ghmfJraJeLJke4C06KMACEbqih3foh5hJ2lqXvoJ3lJaxp4Wc44T0sYok435bkpD2hexhpamkQg8iiisCYJxyXUzEpI05CPE6RCqqsaMJbxHZqmT/BRkp1DiBq0TTlGRtxgn7JfoaPIrdgHnIC4hSCBzYNW6iQ0OAYIHiAyBEbcZJYO4zE1G3YGeGXF1ZyTZoBY2vLv7dfpn8upvcjZLL4f3Pz+Pv1+Obm4fh1xyz+phfaaJBRvaMo41P6F1tvVrbaTr7Tr223dyq7aM3qFHa3Ks3SgtfTS5vk5OrydmP5PjP++rkbJQcnxr09H6GW4sIlADFikoOpUBZxPj0ZI6QVMeSo0J0rjeza6rQp5xKkF83HWJND3Ne27iYBsPKCaHFsBuzoEWlZc+v8wVdpmsfIwakTHAr558fmepa9pJIJ3a71NPWTMEiGPP5HtMdy7Qx7oTEczoE9htCWrOiYh/IqAeiLdvs3w40VZDf4+7Du/WN5kt7oRqYQZhWCIdKmYOjRQXLSpSO1+Ti0/3fYfJtlJz/fji/XtIlJvuZ6U9NWWA3p/00xnIGMGshhgmWMA91FtJtFgRMQdSzeS+bVAvu2yDxeblcLuQAX+noP0G8oD8="},{default:t(()=>[W]),_:1}),F,a(o,{id:"code-demo-48",type:"normal",title:"%E8%AF%B7%E6%B1%82%20Token%20%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81",code:"eJxVUD1PwzAQ/SunTEmGZudLKYgFCQlRumUxqQluXdvY56Kq6sDWkaE7YmNjZOTPoPRvcE5CQ08eTvfePb93q2jKFiw6ivJb7vBCK7RaSm4LRYMnLyyfDG3lCHBofYmaEOPvpSihlMw5GHp87NdgVahCAZWxYsGQw4NQTMLVM45RSAfTrjn+42Vp2jaQwm77Vm9eUc94B9IsN8yyOXhH4rvtR735+vl+r18+e4Ll6K2Cu/9rWdvkN9rhNTNGqCouoqyVjpLOYpuDghuKxy8VClyejNAS+wwYBeM0KinFmH6Pm4PQkc71ZAkjXnpL9IA05pI+eqhWBZoP4XQfe1BxxS0pNm7jsEgjDCqKzXmcJPvDhOqiHToc6Fnc6AZuYK0LRS9a/wIzf6QF"},{default:t(()=>[O]),_:1}),R])}const Y=r(h,[["render",I],["__file","spring-security-jwt.html.vue"]]);export{Y as default};
